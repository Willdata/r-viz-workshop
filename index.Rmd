---
title: "新聞中的資料圖表工作坊｜`ggplot2` 繪圖教學"
subtitle: "資料新聞專案下午茶"
author: "知了新聞團隊"
date: "3/19/2017"
# date: "`r Sys.Date()`"
output: 
  ioslides_presentation:
    logo: images/cicadatatw.png
    widescreen: yes
    incremental: true
---

```{r setup 0, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Getting started

---

### 沒安裝的人今天應該進不來 😈😈😈

<iframe width="560" height="315" src="https://www.youtube.com/embed/fcd6zSk0yd8" frameborder="0" allowfullscreen></iframe>

---

![](http://66.media.tumblr.com/c4693e4e20811bf59390848ca70ae85d/tumblr_o4c7y7geRn1umk6azo1_1280.gif)

## Summit Suen

- Full Stack Developer / Data Scientist.
- 新聞電商推薦系統、輿情監控、運動數據分析
- Taiwan R User Group 共同主持人｜[社群活動](https://www.meetup.com/Taiwan-R/)｜[聚會錄影](https://www.youtube.com/user/TWuseRGroup)
- ![](images/MVP_Logo.png)

## RStudio & R & ...

<img src="https://developer.r-project.org/Logo/Rlogo-1.png" height="80"/>
<img src="https://www.r-project.org/logo/Rlogo.png" height="80"/>
<img src="https://www.rstudio.com/wp-content/uploads/2014/07/RStudio-Logo-Blue-Gradient.png" height="80"/>
<img src="http://revolution-computing.typepad.com/.a/6a010534b1db25970b01b8d151ef48970c-pi" height="80"/>
<img src="http://blog.jupyter.org/content/images/2015/02/jupyter-sq-text.png" height="80"/>

<img src="http://revolution-computing.typepad.com/.a/6a010534b1db25970b01b8d18cfeeb970c-pi" width="600"/>

## RStudio 中文設定

### Tools > Global Options > Default text encoding
<img src="images/rstudio_encoding.png" width="600"/>

## RStudio 初始環境

### Tools > Global Options
<img src="images/rstudio_layout.png" width="600"/>

## RStudio `命令列`介面

### 注意命令列的狀態：`>` or `+`；愛惜生命，常用 `tab` 和 `?`
<img src="images/rstudio_console.png" width="450"/>
<img src="images/rstudio_console2.png" width="450"/>

## RStudio `程式碼` 編輯介面

### 養成在編輯界面撰寫的習慣
<img src="images/rstudio_source.png" width="450"/>

## RStudio 的<del>快樂夥伴</del>快捷鍵們

[All RStudio keyboard shortcuts](https://support.rstudio.com/hc/en-us/articles/200711853-Keyboard-Shortcuts)

功能                    | Windows & Linux    | Mac
----------------------- | ------------------ | --------------------
顯示快捷鍵              | Alt+Shift+K        | Option+Shift+K
自動補完	              | Tab or Ctrl+Space  | Tab or Command+Space
執行（單行／選取範圍）  | Ctrl+Enter         | Command+Enter
註解（單行／選取範圍）  | Ctrl+Shift+C       | Command+Shift+C
存擋                    | Ctrl+S             | Command+S
縮排                    | Ctrl+I             | Command+I

## R 到底是什麼東西 R {.build}

### 先把 R 當成計算機
```{r calculator}
1 + 1
sin(2017)
pi
```

## R 到底是什麼東西 R {.build}

### 統計是看家本領
```{r statistics}
# Kolmogorov-Smirnov Tests
ks.test(iris$Sepal.Length, iris$Petal.Length)
```

## R 到底是什麼東西 R {.build}

### 統計是看家本領
```{r statistics density}
plot(density(iris$Sepal.Length), xlim = range(c(iris$Sepal.Length, iris$Petal.Length)), main = "Sample PDF")
lines(density(iris$Petal.Length), col = 2)
```

## R 到底是什麼東西 R

### A/B Testing（媒體、電子商務、流量成長駭客必備工具）
- 我們使用兩套方法做推薦，要比較推薦（或功能）的成效
  + 方法 A：在 10000 點擊有 10 個購買
  + 方法 B：在  5000 點擊有  3 個購買
- 我怎麼知道這兩種方法的轉換率（購買／點擊）是不是明顯不同？

## R 到底是什麼東西 R

### A/B Testing（媒體、電子商務、流量成長駭客必備工具）{.build}
```{r more statistics}
# install.packages("binom")
library(binom)
# Binomial confidence intervals
binom.confint(c(10, 3), c(10000, 5000), methods = "exact")
```

# 資料前處理 `dplyr`

```{r child = 'rbasic.Rmd'}
```

# 資料視覺化 `ggplot2`

```{r child = 'ggplot2-slides/ggplot.Rmd'}
```

# 手把手

# BONUS 時間

## 畫地圖 {.build}

- 讀 shapefile 地圖檔
```{r map 0, echo=TRUE, warning=FALSE, message=FALSE}
# install.packages(c("rgdal", "ggmap"))
# brew install gdal

library(rgdal)
library(ggplot2)
library(ggmap)

shapefile <- readOGR("shapefile", "Town_MOI_1041215_C_Name_臺北市")
```

## 畫地圖 {.build}

- `ggplot2::fortify` 將讀進來的 shapefile 轉換成為 DataFrame
```{r map 1, echo=TRUE}
shapefile_df <- fortify(shapefile)
shapefile_df %>% head()
```

## 畫地圖 {.build}

- 用 `ggplot2` 畫地圖
```{r map 2, echo=TRUE}
map <- ggplot() + 
  geom_path(data = shapefile_df, 
            aes(x = long, y = lat, group = group),
            color = 'gray', size = 1)
print(map)
```

## 畫地圖 {.build}

- 運用座標工具畫出正確的投影
```{r map 3, echo=TRUE}
map_projected <- map + coord_map()
print(map_projected)
```

# 大家掰掰，期待下次見面：）